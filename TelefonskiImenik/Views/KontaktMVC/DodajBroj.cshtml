@model Models.ViewModels.BrojViewModel
@{
    ViewBag.Title = "Dodaj broj";
}

<h2>Dodaj broj</h2>

@using (Ajax.BeginForm("DodajBroj", "KontaktMVC", null, new AjaxOptions
{ }, new { id = "forma1", name = "forma1", enctype = "form-data" }))
{

    <div class:"form-group">
        @Html.LabelFor(m => m.OsobaId)
        @Html.DropDownListFor(m => m.OsobaId, new SelectList(ViewBag.punoime, "Id", "punoime"), "", new { id = "osobaId", @class = "form-control" })
    </div>
    <div class:"form-group">
        @Html.ValidationMessageFor(m => m.BrojTip, "", new { @class = "text-danger" }) <br />
        @Html.LabelFor(m => m.BrojTip)
        @Html.DropDownListFor(m => m.BrojTip, new SelectList(Model.TipBroja, "BrojTipId", "Naziv"), "", new { id = "brojTipId", @class = "form-control" })
    </div>
    <div class:"form-group">
        @Html.ValidationMessageFor(m => m.Broj, "", new { @class = "text-danger" }) <br />
        @Html.LabelFor(m => m.Broj)
        @Html.TextBoxFor(m => m.Broj, new { id = "broj", @class = "form-control", Value = "" })
    </div>
    <div class:"form-group">
        @Html.LabelFor(m => m.OpisBroja)
        @Html.TextAreaFor(m => m.OpisBroja, new { id = "opis", @class = "form-control" })
    </div>
    <button id="btn1" name="spremi" type="submit" class="btn btn-primary">Spremi</button>

}

<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#btn1").click(function () {
            var broj = new Object();
            broj.OsobaId = $("#osobaId").val();
            broj.BrojTipId = $("#brojTipId").val();
            broj.Broj = $("#broj").val();
            broj.Opis = $("#opis").val();
            $.ajax({
                url: "http://localhost:51809/api/Kontakt/DodajBroj",
                type: "POST",
                datatype: 'JSON',
                data: broj,
                async: false,
                success: function (data) {
                    alert('Uspješno spremljeno!');
                },
                error: function () { alert("Obvezna polja nisu ispunjena"); }
            });
        });
    });
</script>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}